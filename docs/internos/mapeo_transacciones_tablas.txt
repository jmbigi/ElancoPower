================================================================================
MAPEO DE REFERENCIA S/4HANA: TRANSACCIONES SAP A TABLAS
Resumen Ejecutivo: Mapeo de Transacciones y Tablas SAP para S/4HANA
================================================================================
Proyecto: Elanco Power
Fecha: 8 de noviembre de 2025
Propósito: Referencia técnica rápida para desarrolladores y analistas.
================================================================================

La confirmación de que el sistema fuente es **S/4HANA** define la estrategia de replicación. El foco principal es la tabla **`ACDOCA` (Universal Journal)**. Rango vigente (MVP) de tablas a replicar: **19 núcleo + hasta 6 condicionales = 19–25**. Este documento se actualizó el 08-nov-2025 para reflejar la optimización basada en Universal Journal, reemplazando rangos históricos (~35–65, ~70–90, ~76–85).
La confirmación de que el sistema fuente es **S/4HANA** define la estrategia de replicación. El foco principal es la tabla **`ACDOCA` (Universal Journal)**. Rango vigente (MVP) de tablas a replicar: **24 núcleo + hasta 7+ condicionales**. Este documento se actualizó el 08-nov-2025 para reflejar la optimización basada en Universal Journal y la promoción de tablas maestras al núcleo.

--------------------------------------------------------------------------------
SECCIÓN 1: EL FOCO PRINCIPAL - UNIVERSAL JOURNAL (FI/CO)
--------------------------------------------------------------------------------

| Módulo | Transacción | Tabla Clave S/4HANA | Observación |
| :--- | :--- | :--- | :--- |
| **FI/CO** | FAGLL03, KSB1, FB03, F.08, F.01 | **ACDOCA** (Universal Journal) | **CRÍTICA #1.** Sustituye BSEG, COEP, FAGLFLEXA. Eliminamos replicación de tablas antiguas para reducir alcance. |
| **FI/CO** | FAGLL03, F.08, F.01 | **ACDOCA_T** | Totales pre-agregados (balance / trial balance) – mejora performance de saldos. |
| **Maestros CO** | KSB1 | **CSKS, CSKA, AUFK** | Dimensiones y órdenes internas (sin cambios en S/4). |
| **FI Clásico** | FBL1N, FBL5N | **BKPF** | Cabecera de documento. Partidas individuales derivan de ACDOCA (filtradas por tipo de cuenta). |
| **Maestros FI** | FAGLL03, F.01 | **T001** | Maestro de Sociedades (atributos como moneda, nombre). |

--------------------------------------------------------------------------------
SECCIÓN 2: MATERIALES Y LOGÍSTICA (MM/SD)
--------------------------------------------------------------------------------

| Módulo | Transacción | Tabla Clave | Propósito |
| :--- | :--- | :--- | :--- |
| **MM** | ME2L, ME23N | **EKKO, EKPO** | Cabecera y posición de pedidos de compra. |
| **MM** | MB59, MB5B | **MKPF, MSEG** | Movimientos de material (cabecera/posición). |
| **MM** | MM60 | **MBEW** | Valoración y costos estándar (CRÍTICA). |
| **MM** | ZLEL008, MB5B | **MARD, MARC** | Stock por almacén (MARD) y datos de material por planta (MARC). |
| **MM (Condicional)** | MB5B (detalle lote), ZLEL008 (si requiere lote) | **MCHB** | Stock por lote (solo si KPI exige granularidad). |
| **SD** | VA05 | **VBAK, VBAP** | Cabecera y posiciones de órdenes de venta. |
| **SD** | VA05 | **VBUK, VBUP** | Estatus de cabecera y posición (CRÍTICO). |
| **SD (Condicional)** | VA05 | **VBEP** | Schedule lines (fechas programadas) – fundamental para backlog. |
| **SD (Condicional)** | VA05 | **VBFA** | Flujo de documentos de ventas (pipeline). |

--------------------------------------------------------------------------------
SECCIÓN 3: DATOS MAESTROS Y CONDICIONES
--------------------------------------------------------------------------------

| Módulo | Transacción | Tabla Clave | Propósito |
| :--- | :--- | :--- | :--- |
| **Maestros** | XK03, XD03 | **BUT000** | Business Partner unificado (CRÍTICO). |
| **Maestros** | XD03 | **KNA1** | Cliente (incluida en núcleo). |
| **Maestros** | XK03 | **LFA1** | Proveedor (incluida en núcleo). |
| **Maestros (Condicional)** | XD03 | **KNB1, KNVV** | Vistas cliente (contratos/segmentos) – incluir solo si KPI exige. |
| **Maestros** | MM60, VA05 | **MARA, MAKT** | Maestro y descripciones de material (incluidas en núcleo). |
| **Precios (Condicional)** | ZVEL015 | **KONV, KONP** | Pricing detallado (incluir solo si caso de uso pricing histórico). |
| **Plan de Cuentas** | F.01 | **SKA1** | Jerarquías contables para reporte estructurado (incluida en núcleo). |

--------------------------------------------------------------------------------
SECCIÓN 4: TABLAS ESPECIALES (CLUSTER Y CUSTOM)
--------------------------------------------------------------------------------

| Módulo | Tabla | T-Code Asociado | Estrategia S/4HANA |
| :--- | :--- | :--- | :--- |
| **FI** | **BSEG** | N/A | **OBSOLETA** (Sustituida por ACDOCA). No replicar. |
| **FI** | **COEP** | N/A | **OBSOLETA** (Sustituida por ACDOCA). No replicar. |
| **FI** | **FAGLFLEXA** | N/A | **OBSOLETA** (Sustituida por ACDOCA). No replicar. |
| **Global (Condicional)** | **STXL** | (Textos) | Replicar solo si se requieren textos largos; requiere declustering SLT. |
| **CO-PA (Condicional)** | **CE1xxxx, CE4xxxx** | KE24 | Necesarias si se usa Costing-Based CO-PA. |
| **Custom** | ZLEL008, ZVEL015 | N/A | Análisis ABAP para confirmar tablas subyacentes antes de definir alcance final. |

--------------------------------------------------------------------------------
SECCIÓN 5: CONCLUSIÓN DEL MAPEO
--------------------------------------------------------------------------------

| Prioridad | Tablas / Estrategia | Razón |
| :--- | :--- | :--- |
| **CRÍTICA A** | Replicar **`ACDOCA`** y **`ACDOCA_T`** | Sustituye estructuras FI/CO legacy (BSEG, COEP, FAGLFLEXA). |
| **CRÍTICA B** | Replicar **`VBUK/VBUP`** y **`MBEW`** | Estatus SD y valorización MM esenciales para KPIs. |
| **CORE LOGÍSTICA** | Replicar **`MARD`** y **`MARC`** | Stock por almacén y datos de planta. |
| **ANÁLISIS Z** | Código ABAP `ZLEL008` y `ZVEL015` | Identificar tablas Z antes de activar replicación. |
| **CONDICIONAL BACKLOG** | Evaluar **`VBEP`** | Activar si se requiere análisis de pedidos pendientes. |
| **CONDICIONAL PRICING** | Evaluar **`KONV/KONP`** | Activar si caso de uso detallado pricing histórico confirmado. |
| **CONDICIONAL TEXTOS** | Evaluar **`STXL`** | Activar si se requieren textos largos (declustering). |
| **CONDICIONAL LOTE** | Evaluar **`MCHB`** | Solo si KPIs requieren granularidad por lote. |

--------------------------------------------------------------------------------
SECCIÓN 6: RESUMEN NUMÉRICO DEL ALCANCE (MVP)
--------------------------------------------------------------------------------

| Categoría | Conteo | Estado |
|-----------|--------|--------|
| Tablas núcleo (incluir) | 24 | Confirmadas para robustez de reportes. |
| Tablas condicionales | 7+ | Activación sujeta a validación KPI/caso uso. |
| Tablas obsoletas | 3 | Excluidas (BSEG, COEP, FAGLFLEXA) |
| Total potencial | 24–31+ | Rango vigente |

Nota: Tablas de compatibilidad (LFB1, KNB1, KNVV) fuera de MVP salvo requerimiento explícito en procesos P2P o segmentación extendida de clientes/proveedores.

--------------------------------------------------------------------------------
SECCIÓN 7: NOTA DE CONSISTENCIA
--------------------------------------------------------------------------------
Este documento está alineado con:
- `docs/internos/mapeo_transacciones_tablas_detallado.csv` (estado_inclusion)
- `docs/entregables/ALCANCE_TABLAS_E_INDICES.md` (política de particionamiento y clustering)
- `docs/propuesta_final/ANEXO_TECNICO_TRANSACCIONES_VS_TABLAS.md` (rango 19–25)

Última actualización: 08-nov-2025
